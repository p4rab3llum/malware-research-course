![header](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/header.png)

**Disclaimer: All materials are provided for educational purposes only. The author(s) of the course are not responsible for any of your actions before or after studying the material provided in the course.**

## Introduction

We all use programs in one way or another every day to perform various tasks, whether it's playing in Dota 2, watching videos on YouTube, or just texting with someone.

But not all programs are meant to bring good and light into our lives. Some of them have very undesirable tasks - stealing or spoiling your personal data, using your hardware for other people's purposes without your knowledge, etc.

In fact, this course is devoted to these programs.

Still think that you are not in danger? I suggest you look at the picture below:

![redline-distribution](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/redline-distribution.jpg)

For those who are in the tank: above is a very simplified statistic of *recorded* by BitDefender antivirus detection of one of the malicious products.

In fact, that's why there are still various protection solutions in our world: anti-viruses, IDS, DLP and a billion other things, each of which costs as much as several brand-new Ferrari cars in maximum configuration.

But it's not so simple here either. All of these systems can't function in isolation without human involvement, since they need to keep their internal databases up to date in order to detect new types of malware. That is exactly what malware analysts do, which you (maybe) will become after studying all the material in this course.

## General Terminology

![terminology](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/terminology.png)

Before we dive in, it's worth familiarizing ourselves with a couple of terms that we will often use in our future work:

▾**Sample** - a single example of some kind of malware.  
▾**C2 / C&C** - the management server that hosts the tools that the attacker uses in his attack.  
▾**Crypting / obfuscation** - protection of the application source code from analysis by anti-virus solutions / malware researchers.  
▾**Легитимность** - permission to perform certain acts, supported by an appropriate document.  

If you don't understand everything yet, that's fine. Most likely you will be able to get into the subject as you go along.

> By the way, technically speaking, maliciousness is just a set of certain characteristics, not a precise term. This is why the same TeamViewer can be considered malicious (and several times this has even happened in court cases), because you can use it, for example, to remotely access your work PC (This is not punishable in any way. After all, you surely have permission from yourself to connect to your own PC), but, at the same time, to siphon or delete trade secret data from the PC of an employee of a competing company (for which you may have people in black masks with machine guns in their hands).

## Malware types

![malware_types](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/malware_types.png)

At the moment there are the following types:

* **Loaders**
* **Droppers**
* **Network worms**
* **RATs**
* **Stealers**
* **Miners**
* **Ransomware**
* **Rootkits / Bootkits** 
* **AdWare**

It is worth noting that this division is rather relative, since there are few examples of "pure" products of any of the types nowadays, which do not have features inherent to the other type. It is also worth mentioning that some types, such as Trojans, I cannot exactly classify as one of the types described above, as I consider it more of a stealth technique than something special.

But let's not go into the kinks of terminology, let's rather look at what is the informal basis.

### Loaders

![loader](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/loader.png)

**Loader** - a malicious program whose main purpose is to download another malicious application from a remote server and then run it.

This type of malware is often used to initially infect a device. This is due to the following reasons:

1. Small weight of the executable file.
2. If you try hard enough, it may not contain any code that is malicious from the point of view of security solutions.
3. A failed launch most often does not affect the detection of the main payload (downloadable software).

There are two types of loaders: non-resident and resident. This makes no difference to the user who launched it, but it makes a difference to the intruder, because in the first case the loader is launched in the system, performs tasks, and dies after a reboot. In the other case, the loader, when launched for the first time, is registered in the system (either in the registry, or as a service, or in the atostartup, etc.), and only after that starts to perform tasks.

> tl;dr for the paragraph above: non-resident - not fixed in the system, resident - fixed.

Well-known examples: [Smoke Loader](https://attack.mitre.org/software/S0226/), [BazarLoader](https://attack.mitre.org/software/S0534/), [Matanbuchus](https://blog.cyble.com/2022/06/23/matanbuchus-loader-resurfaces/)

### Droppers

![dropper](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/dropper.png)

**Dropper** - malicious program whose main task is to unpack and then launch other malicious applications.

This type of malware is very similar to loaders, but there is a fundamental difference between them: in a dropper, the code of the malicious application to be launched is initially located inside it, rather than being downloaded from somewhere else.

> Lyrical digression: Technically, it is possible to make a dropper out of any program. To do this, it is sufficient to make a "wrapper" around it in the form of another program that will decompress the first one. This is roughly how the notorious [VMProtect](https://vmpsoft.com/) works.

### Network worms

![network-worm](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/network-worm.png)

**Network worm** - a malicious program whose main task is to spread itself to as many hosts (devices) as possible.

This type of virus was one of the first to emerge and was originally conceived not as a malicious program, but as an opportunity for a developer to independently test his own level of programming training.

Nevertheless, the first worms quite often lacked a mechanism for checking devices for self-infection, as a result of which in small networks they multiplied uncontrollably and multiplied (as the God willed), clogging all available disk space at incredible speed and leading to disruption of both individual devices and networks as a whole.

At the moment such a malware is not particularly widespread due to the complexity of creation and the need to adapt to multiple platforms.

Well-known examples: [ILOVEYOU](https://en.wikipedia.org/wiki/ILOVEYOU), [Morris Worm](https://en.wikipedia.org/wiki/Morris_worm), [Code Red](https://en.wikipedia.org/wiki/Code_Red_(computer_worm))

### RATs

![rat](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/rat.png)

**RAT** - malicious program whose main purpose is to surreptitiously spy on the user and selectively exfiltrate (download to a remote server) data.

This type of malware is a malicious offshoot of legitimate remote access tools, such as TeamViewer and the like, but, unlike them, it often has useful (for an attacker) functions onboard, such as working with files, sending commands through a hidden command console window, etc.

But what schoolboy hasn't dreamed of hacking his math teacher? Especially for such "clever kids", the originally professional product has some humorous features, such as turning the sound up to maximum, inverting the desktop, or replacing the standard cursor with a man's dick, which, of course, is a lot of fun for an immature child's mind.

Of the famous representatives we can single out the legendary [njRat](https://malpedia.caad.fkie.fraunhofer.de/details/win.njrat) (which, by the way, is still in use today), opensource [AsyncRat](https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp) и [b0rat](https://www.bleepingcomputer.com/news/security/new-borat-remote-access-malware-is-no-laughing-matter/) (made a lot of noise in the infosec community relatively recently).  

> **Interesting fact**: The abbreviation "RAT" comes from "Remote Administration Tool", but can also be translated as "rat", which, to some extent, reflects the purpose of this type of virus.


### Stealers

![stealer](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/stealer.png)

**Stealer** - is malware software that is used to steal sensitive information (logins, passwords, card details, etc.) from a potential victim.

It is currently one of the most common types of malware. It is practically not used in attacks on large organizations due to the fact that it does not meet the necessary criteria for such operations.

Disseminated mainly under the guise of various "cracks" of popular programs, cheats for well-known games, and sometimes simply embedded in another application. The most recent examples of such phenomena are malicious [advertising campaigns](https://www.youtube.com/watch?v=jXrSSq1D0e8) of the trojanized version of [OBS](https://obsproject.com/).

> All this is mostly not done by professionals, but children 13-17 years old from the former Soviet Union, who all know "**Who works for RU - they come to him in the morning**" and therefore work only for foreign nationals. True, when the same people were scamming on Avito in 2019, no one thought about it, but that, however, is another story.

Well-known examples: [Redline](https://www.bleepingcomputer.com/news/security/redline-malware-shows-why-passwords-shouldnt-be-saved-in-browsers/), [Raccoon](https://malpedia.caad.fkie.fraunhofer.de/details/win.raccoon), [Vidar](https://malpedia.caad.fkie.fraunhofer.de/details/win.vidar)

### Miners

![miner](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/miner.png)

**Miner** — malicious program that uses the resources of an infected computer to mine cryptocurrency. 

It is worth stating that a miner is not always something illegal. There are miners that users voluntarily install on their devices in order to make money. If such software was installed without their knowledge and profits someone else, then it is a full-fledged malware.

This type of malware is quite specific, and the only more or less known example is [SilentXMRMiner](https://github.com/UnamSanctam/SilentXMRMiner).

### Ransomware

![ransomware](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/ransomware.png)

**Ransomware** - malicious software, designed for extortion, blocks access to a computer system or prevents it from reading the data recorded on it (often using encryption techniques), and then demands a ransom from the victim to restore the original state.

These programs are usually used in attacks on organizations and rarely target ordinary users. The reason for this is one: the company can clearly pay more than the average user.

Most people think of ransomware as a ransomware, but this is not entirely true. The term ransomware also includes WinLockers, Ransomware, and even sites threatening to transfer 100 dollars to a phone number, or the police will come after you for viewing illegal gay porn.

But back to the point. Ransomware, although it falls under the well-known definition, is more of an encryption program, since all other representatives of this kind, though they can scare a lot, but usually do not cause any significant harm.

> Contrary to popular belief, the first ransomware was written not in the CIS, but in America back in 1989. Another thing is that the first people to use it "industrially" were from the Russian Federation, Belarus, and Ukraine.

Well-known examples: [Conti](https://en.wikipedia.org/wiki/Conti_(ransomware)), [REvil](https://en.wikipedia.org/wiki/REvil), [LockBit](https://www.kaspersky.com/resource-center/threats/lockbit-ransomware).

### Rootkits / Bootkits

![rootkit-bootkit](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/rootkit-bootkit.png)

A rootkit is a set of software tools (e.g., executables, scripts, configuration files) used to mask objects (processes, files, directories, drivers), manage system events, and collect data (system parameters).

Initially, rootkits only existed for Unix-like systems, but over time they have been adapted to other operating systems as well.

Rootkits fall into two categories: user level and kernel level. The first get the same privileges as a normal application running on the computer. They inject themselves into other running processes and use their memory. This is the most common variant. As for kernel-level rootkits, they work at the deepest level of the OS, gaining the maximum level of access on the computer.

It is one of the most dangerous types of malware, as it is equipped with advanced means of hiding from detection, even by specialized software.

There is also a more exotic and advanced variation of rootkits: bootkits. Their fundamental difference is that they modify the bootloader of the device, thus taking control of the system before it even starts.

Notable examples include [ZeroAccess](https://nakedsecurity.sophos.com/zeroaccess2/), [Alureon](https://en.wikipedia.org/wiki/Alureon) and [Necurs](https://securityintelligence.com/the-necurs-botnet-a-pandoras-box-of-malicious-spam/).

### AdWare

![adware.png](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/adware.png)

**Adware** — a program designed to show ads on your computer, redirect search queries to advertising websites, and collect marketing information about you (such as what kind of sites you visit) so that ads are relevant to your interests.

Such software can be distributed either as an executable file (in which case it is likely to affect all browsers) or as an individual add-on (in which case its range of action will be limited to the only browser where the add-on is installed).

Most often such software masquerades as popular and popular programs for ordinary users: VPNs, various tracker blockers or video downloaders from YouTube, among others. The main purpose of such actions is to convince the user that the application or extension is needed for something.

Some notable examples are the browser [Amigo](https://www.pcrisk.com/removal-guides/8922-amigo-pup). Although it performed its direct duties well, the number of questionable advertisements was out of line. This was one of the reasons why its development (after numerous user complaints) was discontinued in July 2018.

By the way, there is still a debate as to whether AdWare should be classified as malware, since in fact it often does not cause any direct damage (financial or material) to the user. Nevertheless, more and more countries are introducing a law establishing liability for spam, and what else can be considered annoying notifications "**Jane, 39 years old, 100 meters away from you**" 100 times a day?

## Frequently asked questions

![questions](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/questions.png)

Almost everyone who is new to this topic asks the same questions. Below I have tried to answer the most popular ones.

**Q**: What programming languages are malware usually developed in?
**A**: Malware is developed in various languages, but mostly in C, C++, C#, script langs like Powershell & Bash, and the newfangled Rust and Go. Malware in Assembly occurs, but is quite rare and is most often used only in targeted attacks.

**Q**: Can an antivirus completely protect me from all threats?
**A**: Of course not. The only thing antivirus can protect you from is **familiar** threats (but not always). As it is, the main center of security (and the cause of 99% of the dangers) is located between the chair and the monitor of the device.

**Q**: Is there any malware for mobile platforms?
**A**: Naturally. Malware can be created for any of the currently existing platforms, which is:
1. Windows
2. Android
3. Linix
4. macOS
5. etc.

**Q**: So what are Trojans and viruses?
**A**: Since I do not fully adhere to the official terminology (does it even exist?), I will give my view of it. A Trojan (like a Trojan horse from Greek mythology) is a program which hides malicious features unknown to the user. However, the program can still have its declared functionality. Viruses are "local" versions of network worms, since their main purpose is the same: to multiply and multiply, but in contrast to their more advanced fellows, they are not able to work with a network.

## Useful Resources

![resources](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/resources.png)

[**VirusTotal**](https://www.virustotal.com) - A site capable of checking for information about a suspicious file, IP or link in the databases of more than 60 anti-viruses.  
[**ANY.RUN**](https://any.run/) - Interactive dynamic file analyzer. It is suitable if you are investigating a malware that is not too heavily protected.  
[**UnpacMe**](https://www.unpac.me/#/) - Online unpacker of executable files. Most often more or less successfully removes protection (partially or completely) if there is no virtualization / virtual machine protection of any kind.  
[**Unprotect Project**](https://unprotect.it/) - A collection of techniques for evading defensive solutions.  
[**ORKL**](http://orkl.eu/) - Threat Intelligence report aggregator supported by the community.  

## What's next

![whats-next](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/whats-next.png)

Today's session is over. Next time we'll look at the techniques that malware developers use to hide their creations from the watchful eyes of antivirus companies and Threat Hunting departments, see how they work, and even write our own implementation of one of them!

## Homework

![homework](/Course/0x01.%20Getting%20Started%20in%20Malware%20Research/images/homework.png)

[Setting up a virtual environment](homework.md)
